<?xml version="1.0" encoding="utf-8"?>
<!-- 
INTEL CONFIDENTIAL -  Shared with Lenovo under Lenovo CNDA 6040634 
                      andÂ covered by the Feedback License Agreement
                      between Intel and Lenovo, dated July 24, 2018

*** REVIEW DRAFT - SUBJECT TO FUTURE CHANGES ***

This file contains a sample "health report" issued by a cloud HAS service. 
Sample-only (data being used is artificial and not correlated). An XSD schema and documentation for the format will be provided with the final version. 
The extra line breaks and in-doc comments are included for explanatory purposes only, and not meant to provide normative definition on the attestation policies, for example.
Refer to TDS specification for such a definition.
-->
<Intel_TDS_Health_Report report_version="0.6" 
                         tds_version="0.1.0.0"
                         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                         xmlns="https://name_to_be_defined.intel.com/Intel_TDS_Health_Report.xsd" 
                         xsi:schemaLocation="https://name_to_be_defined.intel.com/Intel_TDS_Health_Report.xsd ../schema/Intel_TDS_Health_Report.xsd" >
  
  <ReportHeader>    
    <RequesterNonce>0011223344556677889900AABBCCDDEEFF<!-- [OPTIONAL] The nonce (e.g. a challenge from the MDM) - copied from the request--></RequesterNonce>
    <Appraisal_Request hash_algorithm="SHA256" location="file://ReportRequest-unique-id-goes-here.xml"><!-- [OPTIONAL] Reference to the full request (hash of request body) -->
      53bf876442fe45d55b738d47f3d2431c3369dd91b12c17bc9ee264ec90ad42f0
    </Appraisal_Request>
    <ReportTimestamp>2019-11-07T09:30:10Z</ReportTimestamp>
  </ReportHeader>
  
  <DeviceProperties>
    <DeviceIdentifier type="UUID">05FA4990-E501-4990-FA05-01E59049FA05</DeviceIdentifier>
    <PMF_ProductName>WhiskeyLake Client Platform</PMF_ProductName>
    <PMF_SKUNumber>System SKU Number</PMF_SKUNumber>
    <PMF_OEMBuildNumber>0</PMF_OEMBuildNumber>
    <PMF_OSBuildNumber>10.0.18362</PMF_OSBuildNumber>
    <PMF_BIOSVersion>CNLSFWR1.R00.X209.B00.1906142252</PMF_BIOSVersion>
    <PMF_CSME_FW_Version>12.0.0.7000</PMF_CSME_FW_Version>
  </DeviceProperties>
  
  <HealthState>
    <!-- <State> contains a result of platform's health evaluation. One of:
           * HEALTHY - if *all* of the policies evaluate to a GOOD state or NOT_EVALUATED (in case of optional policies)           
           * UNHEALTHY - if *any* policy evaluates to a BAD state
           * SUSPICIOUS - if *any* policy has evaluated to a SUSPICIOUS state and *no* policies have evaluated as BAD-->
    <State>HEALTHY</State>
    
    
    <!-- <PolicyEvaluation> contains per-policy details of the health evaluation.
         Each policy has a 'policyStatus' attribute value of which is one of: GOOD | BAD | SUSPICIOUS | NOT_EVALUATED
         -->
    <PolicyEvaluation>
      
      <TDSActivationState policyStatus="GOOD">        
        <State>ACTIVE</State>
      </TDSActivationState>
      
      <TDSConfiguration policyStatus="GOOD"> 
        <!--- 
        ~Example~ evaluation logic:
        * 'GOOD' - indicates that the value of the <TDSConfiguration> is matching all of the following:
                   1) The "expectations" of this HAS instance 
                      - if the HAS has a pre-configured 'expected' TDS configuration -> compare with the reference
                      - compare with the Intel-recommended|required settings for TDS          
                   2) The PMF
                   3) The 'Seal Measurement Event' measured to PCR[5]
        * 'BAD' - otherwise
        -->
        <ChassisIntrusionDetection>1</ChassisIntrusionDetection>
        <BIOS_lock>1</BIOS_lock>
        <SealSigning>1</SealSigning>
        <CustomOptOut>1</CustomOptOut>
        <SED_Lock>1</SED_Lock>
        <PMF_Signing>0</PMF_Signing>
        <SealTimeDiskMeasurement>0</SealTimeDiskMeasurement>
        <BootTimeDiskMeasurement>0</BootTimeDiskMeasurement>
        <IntelBootGuard>1</IntelBootGuard>
      </TDSConfiguration>
      
      <SealState policyStatus="GOOD">
        <State>INTACT</State>
      </SealState>
      
      <SealSignature policyStatus="GOOD">
        <SigningMethod>TL3</SigningMethod>
        <SealDataValidity>VALID</SealDataValidity> <!-- 'VALID' indicates that the sealSig struct contains a valid hash(for TL3) or signature (for TL1/2) of the SEAL DATA - i.e. that the data is integral -->
        <Trustworthiness>TRUSTED</Trustworthiness> <!-- 'TRUSTED' indicates that: 
                                                          a) (for TL3) the Seal Integrity Data is matching its value stored in the OEM backend, or
                                                          b) (for TL1/2) the seal was signed with an authorized key -->
      </SealSignature>

      <PMFValidity policyStatus="GOOD"> <!-- 'GOOD' implies: not-expired & PMF signature is valid and trusted (if signed PMF is in use) & PMF hash matches Seal Integrity Data -->
        <Signature>NOT_SIGNED</Signature>
        <GeneratedDate>2019-11-07</GeneratedDate>
        <ExpireDate>2029-11-07</ExpireDate>
      </PMFValidity>

      <TPMQuoteSignature policyStatus="GOOD">
        <Validity>VALID</Validity> <!-- 'VALID' implies: signature is valid (data is integral) & quoted PCRs match the <PCRMeasurements> section & the Quote was issued in response to the valid previous HAS challenge -->
        <AIK_Trustworthiness>TRUSTED</AIK_Trustworthiness>
      </TPMQuoteSignature>

      <TPMLogTrustworthiness policyStatus="GOOD"/>
      
      <BootGuardProfile5 policyStatus="GOOD"/>

      <SealMeasuredToPCR5 policyStatus="GOOD"/>

      <SealLog policyStatus="GOOD">
        <Event index="0" time="2019-11-06T12:34:00Z">
          <SealConfigured sealInstanceID="4216834284"/>
        </Event>
        <Event index="1" time="2019-11-06T12:34:00Z">
          <SealEnabled />
        </Event>
        <Event index="2" time="2019-11-06T12:36:00Z">
          <DiskLockPasswordRetrieved stage="PRE_BOOT" bootCounter="1" executionCounter="0" />
        </Event>
        <Event index="3" time="2019-11-06T12:36:01Z">
          <DiskLockRemoval bootCounter="1" executionCounter="1" />
        </Event>
      </SealLog>
      
      <PCRMeasurements policyStatus="GOOD">
        <PCR id="0" value="dd368b6de1b270cdecfd185817dcae6cc09e02c16604e9a10d79e86738f7fb06">VALID</PCR>
        <PCR id="2" value="105b0a99c7f3e92811e22d708652d2ec68e24e2adad020a95596565b37c5073a">VALID</PCR>
        <PCR id="3" value="3d458cfe55cc03ea1f443f1562beec8df51c75e14a9fcf9a7234a13f198e7969">VALID</PCR>
        <PCR id="5" value="3d458cfe55cc03ea1f443f1562beec8df51c75e14a9fcf9a7234a13f198e7969">NOT_VALIDATED</PCR>
        <PCR id="6" value="3d458cfe55cc03ea1f443f1562beec8df51c75e14a9fcf9a7234a13f198e7969">VALID</PCR>
      </PCRMeasurements>


      <PartitionMeasurements policyStatus="GOOD"/> <!-- 'GOOD' indicates that:
                                                        1) the GPT event matched the PMF partition list
                                                        2) all of the partition measurements have matched (e.g. BOM file was successfully attested) -->       
    </PolicyEvaluation>
  </HealthState>
    
  <Signature xmlns="http://www.w3.org/2000/09/xmldsig#">
    <SignedInfo>
      <CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315" />
      <SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1" />
      <Reference URI="">
        <Transforms>
          <Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature" />
        </Transforms>
        <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" />
        <DigestValue>5j0QSaZaoZXqH+2rZiFZYj+3OQE=</DigestValue>
      </Reference>
    </SignedInfo>
    <SignatureValue>obV0XS73Gx/C3wXmexweI/KdX7WucbqrniOB0yMUqj5j795fOitzqUK2khEh/B7O8JtUGTvsxq8zgvC0eZhPh3FBJW1NkWrEigyW6NEsHr/MCjJfPloA2BGVZA2E0t9aThbWLI0OwOncqJuJnifgYEuLYlPJT5D0iU6xWvVUxyZ5TCIHLK/Y4kzJHq6tyQ16RNcfAEzKgosZp+okFxVxUSVcjotXSI75AZPUNHzeZwuRChYaGWvnU2kcS2c+Hq8wg5OCTbWtSTkeJwiix0PKvn5l/SPXtPqRWCO6PsjE/w5McHKDA2StSjqJTIFWP4CQoGH/iiqaaPMAG3WatArA09xcefXqRCscJUbqIKkvq12AFxRKSIf4kWX/hCL+mbKup3I63hxS8rdmDgyjGFlLWBlC4OHdrBYtEwlRH3kD2BlX5eYGi9+QPtNJAIluZwtYkWnhI/r+DynpF6UQnZocgWwc1LbYZAhLysMFHcFlHzyWXUu1Ypg0zGxB4CBUzoLl</SignatureValue>
    <KeyInfo>
      <X509Data>
        <X509Certificate>
          MIIC+TCCAeGgAwIBAgIQLjmYobfeK4hA+cWA/HyszjANBgkqhkiG9w0BAQsFADAf
          MR0wGwYDVQQDDBRUUE0gRW5kb3JzZW1lbnQgQ0EwMTAeFw0xOTExMDYxMzA2MTJa
          Fw0yMDExMDYxMzI2MTJaMB8xHTAbBgNVBAMMFFRQTSBFbmRvcnNlbWVudCBDQTAx
          MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsw4Ke0Xx7nh3BJrmXcLA
          3LpSgsrKW2vC/lIDm7YdA2dzrfaxMgx9BNcS9FkRkcLKFT8f4FhM+4Q13Qmun9C4
          WPBJlHQXCFbDxt9lSCl5xWbjLtirQQAf7hmJb8vcCh+3K4oCGZBKY5kHBp6+be4j
          Ssh2v8gnCvFw9xWKpnkyjPK7cOfRV/Q3/VpTSLDeEdqdbj3K5R6VBQaJ1E54OTRt
          cM7M2NORmVVBcQSn+KFZL8MN7lY4P4Qqhm7HmtzRjpQyD04n1yMeSTAWnRWde3SR
          FBJNLiw9WyCWoE6JED5XRLqV3Fw7Vw8/RA7CF/wFgzbBvJglv7RQr91umRiJeE6L
          MQIDAQABozEwLzAOBgNVHQ8BAf8EBAMCAYYwHQYDVR0OBBYEFNdNmVHiMlln820y
          SEwIzKPtA2X+MA0GCSqGSIb3DQEBCwUAA4IBAQAhhCvLpZNGgw6IS6ghW0MpCa0N
          dfpN+EJcuc5AW/kEeppp0r/L78xxGFSSokhkEz1RhJIZDcfnAjZITskgCcfTEn4G
          2boJwICbx0T6GcVzxJIBy5uNqng4690Y4wRR64qqUoPaAvyZsNCrAkkoa2Rbyzzq
          3EYyA3K7Kch5+ONq6CumSy+Nd6uau8NQeqDarEVSiWuft91zEENbCWV36dyTyopJ
          5IRPZ4yG45gHD25abFwTyswDP9paPFOZqsxWSkthF5zW7WHPmiFoGpjS2X6v5GZH
          knTRgksgXfGcjqrSfHt2709IQwcBsqtSMC7CiYi4WO21jE9w3rkCu9DYjF12
        </X509Certificate>
      </X509Data>
      <KeyValue>
        <RSAKeyValue>
          <Modulus>zPciGSQ2xhVFIU7LoZWwO35Dfq2KSEFB82zk7bLLMTJY9V5hZpXUoZkWfC7DmJ4e1HT4hg/G1b/c6MM3/vfMV2G2wVQ4u2nYqY1RHD4pk9b1zSXXf9ks3yoM48FH9/8urGTbd8pDUHuyTWx1g3nKYI4YvuvPy6xIbc++BUiYOp12iqSvZ7WLiYUM7gZ+etSWM6kFZKU3CU0ZIxcgvOy0pSYjRuJ6BG8zDK/yr/tdR6zFOX9TglfCh3i8oCGVJ/RhW4SFSAtAzVjQwgReJEayjAmu1JTa2rBkmlOzccwLwQAFzDWvvW2MeAT8P5UcIeluI1IMzBbQM4RUWHoWGaNYeekgneVk1RMuB6lkQF3jUiOUnvd3wvwcqChif2vtHSRiY4EaNNl1uueqOzKlQZmO9XbknaC2tJEEBRSl2aFMH84bGVx6+hOytZBEmlzbS9l49WeXtwxGdui3vOuYWY6vZ6YCjmtlV1JeXM8WjqUkrz6vjLh8vR5xqPhi2Wl+l/ZZ</Modulus>
          <Exponent>AQAB</Exponent>
        </RSAKeyValue>
      </KeyValue>
    </KeyInfo>
  </Signature>
</Intel_TDS_Health_Report>
